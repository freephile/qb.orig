{# Not sure if WIKI_NAME will be used in non-CGI environments 
   But in any event, we want a name-based farm, not path based #}
SetEnv WIKI_NAME="%{HTTP_HOST}"

<Directory "{{ MW_DIRECTORY }}/mediawiki*">
  <IfVersion < 2.4>
    Allow from all
  </IfVersion>
  <IfVersion >= 2.4>
    Require all granted
  </IfVersion>
</Directory>
{# the instance directory is /var/www/clients #}
{# the double asterisks here are helpful globs #}
<Directory "{{ MW_INSTANCE_DIRECTORY }}/*/*/images">
  Require all denied
</Directory>
{# the mw directory is /var/www/_mw #}
{# I don't think we need the asterisk here #}
<Directory "{{ MW_DIRECTORY }}/mediawiki*/images">
  Require all denied
</Directory>
<Directory "{{ MW_DIRECTORY }}/mediawiki*/mw-config">
  Require all denied
</Directory>
{# We want to vet this and then use it because it does
   great things like drop uncool REQUESTS and sets cache times 
Include {{ APACHE_CONF_DIRECTORY }}/optional.conf
#}

{# Optionally include some Apache configs found in the clients directory 
   Not sure we will need this... but could be a way to customize the Apache config per client
   beyond what we do in the Mass Virtual Hosting setup.
   Make sure that these configuration files are not served
#}
IncludeOptional { MW_INSTANCE_DIRECTORY }}/{{ inventory_hostname }}/{{ inventory_hostname_short }}/*.conf
<FilesMatch "\.conf$">
    Require all denied
</FilesMatch>
